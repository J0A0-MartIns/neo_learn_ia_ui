<h2 mat-dialog-title class="dialog-title">Criar Novo Cronograma de Estudos</h2>

<mat-dialog-content class="dialog-content">
  <form [formGroup]="scheduleForm" class="schedule-form">
    
    <div class="form-group">
      <label for="title">Título do Cronograma</label>
      <input id="title" type="text" formControlName="title" class="form-input" placeholder="Ex: Estudo para Concurso X" required>
      <div *ngIf="scheduleForm.get('title')?.invalid && (scheduleForm.get('title')?.dirty || scheduleForm.get('title')?.touched)" class="error-message">
        <span *ngIf="scheduleForm.get('title')?.hasError('required')">O título é obrigatório.</span>
      </div>
    </div>

    <div class="form-group">
      <label for="dailyHours">Horas de Estudo Por Dia</label>
      <input id="dailyHours" type="number" formControlName="dailyHours" class="form-input" min="1" max="12" placeholder="Ex: 4" required>
      <div *ngIf="scheduleForm.get('dailyHours')?.invalid && (scheduleForm.get('dailyHours')?.dirty || scheduleForm.get('dailyHours')?.touched)" class="error-message">
        <span *ngIf="scheduleForm.get('dailyHours')?.hasError('required')">As horas diárias são obrigatórias.</span>
        <span *ngIf="scheduleForm.get('dailyHours')?.hasError('min') || scheduleForm.get('dailyHours')?.hasError('max')">Horas devem ser entre 1 e 12.</span>
        <span *ngIf="scheduleForm.get('dailyHours')?.hasError('pattern')">Insira um número inteiro.</span>
      </div>
    </div>

    <div class="form-group">
      <label for="totalWeeks">Quantidade de Semanas</label>
      <select id="totalWeeks" formControlName="totalWeeks" class="form-select" required>
        <option value="" disabled selected>Selecione a quantidade de semanas</option>
        <option *ngFor="let week of weekOptions" [value]="week">
          {{ week }} Semana{{ week > 1 ? 's' : '' }}
        </option>
      </select>
      <div *ngIf="scheduleForm.get('totalWeeks')?.invalid && (scheduleForm.get('totalWeeks')?.dirty || scheduleForm.get('totalWeeks')?.touched)" class="error-message">
        <span *ngIf="scheduleForm.get('totalWeeks')?.hasError('required')">A quantidade de semanas é obrigatória.</span>
      </div>
    </div>

    <div class="form-group">
      <label for="studyProject">Projeto</label>
      <select id="studyProject" formControlName="selectedProjectId" class="form-select" required>
        <option value="" disabled selected>Selecione um Projeto</option>
        <option *ngFor="let project of studyProjects" [value]="project.id">
          {{ project.name }}
        </option>
      </select>
      <div *ngIf="scheduleForm.get('selectedProjectId')?.invalid && (scheduleForm.get('selectedProjectId')?.dirty || scheduleForm.get('selectedProjectId')?.touched)" class="error-message">
        <span *ngIf="scheduleForm.get('selectedProjectId')?.hasError('required')">O projeto é obrigatório.</span>
      </div>
    </div>

    <div class="form-group" *ngIf="scheduleForm.get('selectedProjectId')?.value">
      <label for="fileId">Arquivo</label>
      <select id="fileId" formControlName="selectedFileId" class="form-select" required>
        <option value="" disabled selected>Selecione um Arquivo</option>
        <option *ngFor="let file of filteredFiles" [value]="file.fileId">
          {{ file.fileName }}
        </option>
      </select>
      <div *ngIf="scheduleForm.get('selectedFileId')?.invalid && (scheduleForm.get('selectedFileId')?.dirty || scheduleForm.get('selectedFileId')?.touched)" class="error-message">
        <span *ngIf="scheduleForm.get('selectedFileId')?.hasError('required')">O arquivo é obrigatório.</span>
      </div>
    </div>

  </form>
</mat-dialog-content>

<mat-dialog-actions align="end" class="dialog-actions">
  <button mat-button (click)="onCancel()" class="cancel-button">Cancelar</button>
  <button 
    mat-raised-button 
    color="primary" 
    [disabled]="scheduleForm.invalid" 
    (click)="onSubmit()"
    class="create-button"
  >
    Criar Cronograma
  </button>
</mat-dialog-actions>